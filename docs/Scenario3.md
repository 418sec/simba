# SimBA Tutorial:

To faciliate the initial use of SimBA, we provide several use scenarios. We have created these scenarios around a hypothetical experiment that take a user from initial use (completely new start) all the way through analyzing a complete experiment and then adding additional experimental datasets to an initial project.

All scenarios assume that the videos have been [pre-processed](https://github.com/sgoldenlab/simba/blob/master/docs/tutorial_process_videos.md) and that [DLC behavioral tracking .CSV dataframes](https://github.com/sgoldenlab/simba/blob/master/docs/Tutorial_DLC.md) have been created.

# **Hypothetical Experiment**:
Three days of resident-intruder testing between aggressive CD-1 mice and subordinante C57 intruders. Each day of testing has 10 pairs of mice, for a total of 30 videos recorded across 3 days. Recordings are 3 minutes in duration, in color, at 30fps.

# **Scenario 3**: Updating a classifier with further annotated data.
In this Scenario you have generated a classifier using SimBA, but its likely that it could be improved further by including more training data (HINT: SimBA inludes several model evaluation settings that cant be selected by the user when generating the predictive classfiers. This includes learning curves, which tels you how the predictive classifier performs with increasing amount of data. For more information on how to use SimBa to generate learning curves for your predictive classifier, [here](https://github.com/sgoldenlab/simba/blob/master/docs/Scenario1.md#step-7-train-machine-model). For more general information on learning curves in machine learning and their potential for informing on the benefit of additional data, click [here](https://scikit-learn.org/stable/auto_examples/model_selection/plot_learning_curve.html)). In this tutorial, we will use SimBA to add further annotations to the predictive classifier generated in [Scenario 1](https://github.com/sgoldenlab/simba/blob/master/docs/Scenario1.md) to create a classifier that includes more training data. **Note:** In practise, what we are doing in this Scenario is to generate a brand new classifier that contain previously annotated data and new annotated data, rather than building on a already generated classifier.   

## Part 1: Previously annotated .csv files. 

**Locate the previously annotated .csv files**. We will need start with a project directory tree that does not contain any other data than the data we want to use to create the new predictive classifier. If you are coming along from [Scenario 1](https://github.com/sgoldenlab/simba/edit/master/docs/Scenario1.md) you will have one project tree already. The project tree from [Scenario 1](https://github.com/sgoldenlab/simba/edit/master/docs/Scenario1.md) contains critical files that we want to use to create the new predictive classifier. The critical files are located in the `project_folder/csv/targets_inserted` of the [Scenario 1](https://github.com/sgoldenlab/simba/edit/master/docs/Scenario1.md) project. In this folder, there is one file for each video, and each file represents a video and contains the (i) pose-estimation data, (ii) the extracted features, and (iii) annotated behaviours that were created using the [SimBA behavioral annotation GUI](https://github.com/sgoldenlab/simba/blob/master/docs/Scenario1.md#step-6-label-behavior-ie-create-annotations-for-predictive-classifiers). Copy these files to a safe memorable place, or just be aware of their location. We will use them in later.

**Note**: If a predictive classifier has been generated by someone else, and you want to add further data to this and generate a new classifier with more training data, you will need two things:

- You will need the files from the *targets_inserted* folder from the project where the classifier was generated. 

- Regardless if the previous classifier was generated by you or someone else, you will also need information on the resolution, pixels per mm, and fps from the videos used to create the original predictive classifier. This infomation is stored in the *video_info.csv* files generated by SimBA which is located in the `project_folder\logs` directory.

## Part 2: Create a project. 

To create a new project, follow the instructions for creating a new project in either of these tutorials: [1](https://github.com/sgoldenlab/simba/blob/master/docs/Scenario1.md#part-1-create-a-new-project-1), [2](https://github.com/sgoldenlab/simba/blob/master/docs/tutorial.md#step-1-generate-project-config). Instead of using your pilot data as indicated in the tutorial from [Scenario 1]((https://github.com/sgoldenlab/simba/blob/master/docs/Scenario1.md#part-1-create-a-new-project-1), use the pose estimation data and videos for the videos you want to add to the predictive classifier. 

**Important I**: In the final (*Step 4*) of the tutorials for creating a new project, we extract the frames from the imported videos. Having the frames is necessery in this Scenario, as we will render them while annotating behaviors in the [SimBA behavioral annotation GUI](https://github.com/sgoldenlab/simba/blob/master/docs/Scenario1.md#step-6-label-behavior-ie-create-annotations-for-predictive-classifiers). However, you **do not** have to have the frames for the videos that were used to generate the original classifiers. 

**Important II**: Make sure the file names of the new videos and data are not identical to the file names of the previously annotated videos.  

**Important III**: Make sure the the classifier name(s), which is defined when [creating the project](https://github.com/sgoldenlab/simba/blob/master/docs/Scenario1.md#step-1-generate-project-config) in the SML Settings menu, are the same as the classifier name used to create the previous classifier. 

## Part 3: Load project and process your new tracking data

In Part 2, we created a project that contains the data you wish to add to the predictive classifier. To continue working with this project, we **must** load it. To load the project and process your experimental data, follow the instructions for **Step 1-6** in either of these tutorials: [1](https://github.com/sgoldenlab/simba/blob/master/docs/Scenario1.md#part-1-create-a-new-project-1), [2](https://github.com/sgoldenlab/simba/blob/master/docs/tutorial.md#step-1-generate-project-config]. When completed, you will have (i) corrected the outliers present in your new data, (ii) extracted features from your new data, (iii) and annotated behaviours in your new data. For example, if you annotated an additional, new, dataset contain 5 videos, you should see 5 CSV files in the  `project_folder\csv\targets_inserted` directory.

## Part 4: Add the previously annotated .csv files to your `project_folder\csv\targets_inserted` directory. 

**1. Navigate** to the folder that stores the previously annotated CSV files (see **Part 1**). Copy and paste them into your current `project_folder\csv\targets_inserted` directory. You now have all the annotated files that will be used to create your predictive classifier in one place. 

**2. Create a new, updated, video_info.csv file**. In the the current project directory, the *video_info.csv* file generated by SimBA,  which is located in the `project_folder\logs` directory, will so far only include the information from the new videos that you wish to *add* to the classifier. It does not contain the information from the videos that were used to create the previous predictive classifier. To update the video_info.csv file to contain both the new and the older video information, first open the *video_info.csv* file from the **earlier project** (see **Step 1**) and copy its content. Next, open the *video_info.csv* file and paste the content into it. You should now have a *video_info.csv* that contains a row of information for each of the videos and files represented in the `project_folder\csv\targets_inserted` directory:

![](/images/video_info.JPG "video_info")

*Note I*: In this quick example screenshoot the videos have the same resolution, pixels per millimeter, and fps. However, they can of course be in any different combitation of values across videos. 

*Note II*: Make sure that the column *Video* (the first column on the left), has the names of the video files in the `project_folder\csv\targets_inserted` directory (excluding the file format, .csv).    

## Part 5: Generate a new predictive classifier with the new dataset. 

You now have all the necessery data organised to generate a new predictive classifier that includes the data used to generate the original classfier plus data from new annotated videos. To generate a new predictive classifier with these data, see [**Step 7**](https://github.com/sgoldenlab/simba/blob/master/docs/Scenario1.md#step-7-train-machine-model) and onwards in the [Scenario 1](https://github.com/sgoldenlab/simba/blob/master/docs/Scenario1.md) documentation.

Once you have completed **Part 5**, you may want to proceed to either:

- Visualize and validate the new classifier on a video not used during training of the classifier. For validating a classifier on a new video, see Scenario 1 - [Critical validation step before running machine model on new data](https://github.com/sgoldenlab/simba/blob/master/docs/Scenario1.md#critical-validation-step-before-running-machine-model-on-new-data).

- Run the novel classifier on new data. To run the classifier on new data, see Scenario 2 - [Using a classifier on new experimental data](https://github.com/sgoldenlab/simba/blob/master/docs/Scenario2.md#scenario-2-using-a-classifier-on-new-experimental-data).

- Visualize machine predictions on one or several videos. To create visualizations, see Scenario 2 - [Visualizing machine predictions](https://github.com/sgoldenlab/simba/blob/master/docs/Scenario2.md#part-5--visualizing-machine-predictions). *Note*: You can only visualize the predictions on videos for which you have extracted the frames and have feature data for. For more information on extracting frames - click [here](https://github.com/sgoldenlab/simba/blob/master/docs/tutorial.md#step-4-extract-frames-into-project-folder).




